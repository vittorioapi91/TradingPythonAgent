# Example override file for custom configurations
# Copy this to docker-compose.override.yml and modify as needed

version: '3.8'

services:
  grafana:
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=your_secure_password_here
      - GF_SERVER_ROOT_URL=http://your-domain.com:3000
      - GF_INSTALL_PLUGINS=grafana-clock-panel,grafana-simple-json-datasource
    ports:
      - "3000:3000"
      - "3001:3000"  # Additional port if needed

  prometheus:
    volumes:
      - ./prometheus-custom.yml:/etc/prometheus/prometheus.yml:ro
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--storage.tsdb.retention.time=30d'
      - '--web.enable-lifecycle'

  mlflow:
    environment:
      - MLFLOW_BACKEND_STORE_URI=postgresql://user:password@postgres:5432/mlflow
      - MLFLOW_DEFAULT_ARTIFACT_ROOT=s3://mlflow-artifacts
    # Uncomment if using PostgreSQL backend
    # depends_on:
    #   - postgres

  # Uncomment if using PostgreSQL for MLflow
  # postgres:
  #   image: postgres:15
  #   environment:
  #     - POSTGRES_USER=mlflow
  #     - POSTGRES_PASSWORD=mlflow
  #     - POSTGRES_DB=mlflow
  #   volumes:
  #     - postgres-data:/var/lib/postgresql/data
  #   networks:
  #     - monitoring

